<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Web-Interface</title>
    <link rel="shortcut icon" href="">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

    <!-- DataTable -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.css">

    <script type="text/javascript" charset="utf8"
        src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.js"></script>

    <script type="text/javascript" charset="utf8"
        src="https://cdn.datatables.net/scroller/2.0.6/js/dataTables.scroller.min.js"></script>
    <script type="text/javascript" charset="utf8"
        src="https://cdn.datatables.net/select/1.4.0/js/dataTables.select.min.js"></script>

    <link rel="stylesheet" type="text/css"
        src="https://cdn.datatables.net/scroller/2.0.6/css/scroller.dataTables.min.css">
    <link rel="stylesheet" type="text/css" src="https://cdn.datatables.net/select/1.4.0/css/select.dataTables.min.css">


    <!-- vis.js-->
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>

    <style type="text/css">
        #mynetwork {
            width: 100%;
            height: 480pt;
            border: 1px solid lightgray;
        }
    </style>

    <!-- Bootstrap -->

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
        integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>

    <script>
        var metadata_table;
        //var location_table;
        var relationship_table;
        var class_table;
        var network;
        var nodes;
        var edges;

        function proxy_request(url, request_type, data, callback) {

            var json_data =
            {
                url: url,
                request_type: request_type,
                data: data
            };

            var dataToSend = JSON.stringify(json_data);
            var objresponse = null;
            $("body").css("cursor", "progress");
            $('selector').click(false);
            $.ajax({

                url: '/proxy',
                type: 'POST',
                data: dataToSend,

                success: function (jsonResponse) {
                    objresponse = JSON.parse(jsonResponse);
                    $("body").css("cursor", "default");
                    $('selector').click(true);
                    callback(objresponse);
                },
                error: function (jsonResponse) {
                    alert('Something went wrong.');
                }
            });

            return objresponse;

        };

        function check_node(nodeId, include, exclude) {

            if (include[0] == '' && include[0] == '')
                return true;

            for (var k = 0; k < include.length; k++) {
                if (include[k] != '') {
                    if (nodeId.includes(include[k]) == false) {
                        return false;
                    }
                };
            };
            for (var k = 0; k < exclude.length; k++) {
                if (exclude[k] != '') {
                    if (nodeId.includes(exclude[k]) == true) {
                        return false;
                    }
                };
            };
            return true;
        };

        function make_search_result_selectable() {
            $('#search-result-list li').on('click', function () {
                var $this = $(this);
                var $alias = $this.data('alias');

                $('.active').removeClass('active');
                $this.toggleClass('active')
            });
        };

        function slugify(str) {
            str = str.toLowerCase()
                .replace(/ /g, '-')
                .replace(/[^\w-]+/g, '');

            return str;
        }
        function get_metadata_csv(data) {
            list_of_rows = data['list_of_rows'];
            for (var i = 0; i < list_of_rows.length; i++) {
                metadata_table.row.add([i, list_of_rows[i][0], list_of_rows[i][0], list_of_rows[i][1], "", "Started"]).draw();
            }

        };

        function add_row() {
            metadata_table.row.add([metadata_table.rows().data().toArray().length, "", "", "", "", "New Row"]).draw();

        };

        function get_rel_list(data) {
            rel_list = data['rel_list'];

            $("#rel_list_1").empty();
            for (var i = 0; i < rel_list.length; i++) {
                $("#rel_list_1").append('<li class="list-group-item"><b>' + rel_list[i] + '</b></li>');
            }

            $('#rel_list_1 li').on('click', function () {
                var $this = $(this);
                var $alias = $this.data('alias');

                $('.active').removeClass('active');
                $this.toggleClass('active')
            });

            $("#rel_list_2").empty();
            for (var i = 0; i < rel_list.length; i++) {
                $("#rel_list_2").append('<li class="list-group-item"><b>' + rel_list[i] + '</b></li>');
            }

            $('#rel_list_2 li').on('click', function () {
                var $this = $(this);
                var $alias = $this.data('alias');

                $('.active').removeClass('active');
                $this.toggleClass('active')
            });

            $("#rel_list_3").empty();
            for (var i = 0; i < rel_list.length; i++) {
                $("#rel_list_3").append('<li class="list-group-item"><b>' + rel_list[i] + '</b></li>');
            }

            $('#rel_list_3 li').on('click', function () {
                var $this = $(this);
                var $alias = $this.data('alias');

                $('.active').removeClass('active');
                $this.toggleClass('active')
            });

        };

        function suggest_selected_callback(data) {
            matched_classes = data['matched_classes'];
            for (var i = 0; i < matched_classes.length; i++) {
                item = matched_classes[i];
                classname = item[1][0][0];
                row_id = item[0];
                metadata_table.row(row_id).data([row_id, list_of_rows[row_id][1], list_of_rows[row_id][2], list_of_rows[row_id][3], classname, "Auto-suggested"]).draw();
            }
        };

        function search_btn_callback(data) {
            result = data['result'];
            $("#search-result-list").empty();
            for (var i = 0; i < result.length; i++) {
                $("#search-result-list").append('<li class="list-group-item"><b>' + result[i][0] + '</b><span class="badge badge-pill badge-info">' + result[i][1] + '</span></li>');
            }
            make_search_result_selectable();
        };

        function update_model_done(data) {
            //alert('update model done!');
        };

        function reindexing_done(data) {
            //alert('reindexing done!');
        };

        function save_brick_done(data) {
            if (data['endcode'] == 0) {
                alert('A ttl file has been created.');
            } else { alert('Something went wrong!'); }
        };

        $(document).ready(function () {

            data = { input_file: 'NIST.csv' };
            proxy_request("/get_rel_list", "POST", data, get_rel_list);

            // add functions that need to be executed when the web-page is loaded
            function clear_everything() {
                metadata_table.clear();
                //location_table.clear();
                metadata_table.draw();
                //location_table.draw();
                class_table.clear();
                relationship_table.clear();
                class_table.draw();
                relationship_table.draw();
                network.destroy();
                // // create an array with nodes
                nodes = new vis.DataSet([
                ]);

                // create an array with edges
                edges = new vis.DataSet([
                ]);

                // // create a network
                var container = document.getElementById('mynetwork');

                // // provide the data in the vis format
                var data = {
                    nodes: nodes,
                    edges: edges
                };
                var options = {};
                // // initialize your network!
                network = new vis.Network(container, data, options);
                network.on('click', function (properties) {
                    var ids = properties.nodes;
                    var clickedNodes = nodes.get(ids);
                    console.log('clicked nodes:', clickedNodes);
                });

                node_list = [];
                edge_list = [];

            }

            $('#save-brick-btn').click(function (event) {
                data_to_save = {};
                data_to_save['filename'] = $('#brick-file').val();
                list_of_rels = []
                edge_id_list = edges.getIds();
                for (id in edge_id_list){
                    edge_id = edge_id_list[id];
                    list_of_rels.push([edges.get(edge_id)['id'], edges.get(edge_id)['from'], edges.get(edge_id)['to'], edges.get(edge_id)['rel_type']]);
                };
                data_to_save['list_of_rels'] = list_of_rels;
                data_to_save['list_of_nodes'] = nodes.getIds();

                proxy_request("/save_brick", "POST", data_to_save, save_brick_done);

            });

            $('#clear-everything').click(function (event) {
                clear_everything();

            });

            $('#add-row-btn').click(function (event) {
                add_row();

            });

            $('#show-stats').click(function (event) {
                complete = 0;
                pass = 0;
                metadata_table_data = metadata_table.rows().data().toArray();
                for (var i = 0; i < metadata_table_data.length; i++) {
                    if (metadata_table_data[i][4] == 'Complete') {
                        complete += 1
                    }
                    if (metadata_table_data[i][4] == 'Pass') {
                        pass += 1
                    }
                }

                percent = ((complete / metadata_table.rows().data().toArray().length) * 100).toFixed(2);
                alert(complete + ' rows have been completed of ' + metadata_table.rows().data().toArray().length + " rows. (" + percent + " %)");

            });

            $('#add-to-canvas-btn').click(function (event) {
                list_of_selected_rows = relationship_table.rows('.selected').data().toArray();
                for (var i = 0; i < list_of_selected_rows.length; i++) {
                    edge_id = list_of_selected_rows[i][0];
                    from_node_id = list_of_selected_rows[i][1];
                    to_node_id = list_of_selected_rows[i][2];
                    edge_type = list_of_selected_rows[i][3];

                    node_ids = nodes.getIds();
                    if (node_ids.includes(from_node_id) == false)
                        nodes.add({ id: from_node_id, label: from_node_id });
                    if (node_ids.includes(to_node_id) == false)
                        nodes.add({ id: to_node_id, label: to_node_id });

                    edge_ids = edges.getIds();
                    if (edge_ids.includes(edge_id) == false) {
                        edges.add({
                            from: from_node_id, to: to_node_id, rel_type: edge_type, id: edge_id,
                            arrows: {
                                to: {
                                    enabled: true,
                                    type: "arrow",
                                }
                            }
                        });
                    }
                };
            });

            function checkpoint_done(data) {
                if (data['endcode'] == 0) {
                    alert('A Checkpoint has been created.');
                } else { alert('Something went wrong!'); }
            }

            function get_checkpoint_done(data) {
                if (data['endcode'] == 0) {

                    list_of_rows = data['data']['metadata_table_data'];
                    for (var i = 0; i < list_of_rows.length; i++) {
                        metadata_table.row.add([list_of_rows[i][0], list_of_rows[i][1], list_of_rows[i][2], list_of_rows[i][3], list_of_rows[i][4], list_of_rows[i][5]]).draw();
                    }
                    /*
                    list_of_locations = data['data']['location_table_data'];
                    for (var i = 0; i < list_of_locations.length; i++) {
                        location_table.row.add([list_of_locations[i][0], list_of_locations[i][1], list_of_locations[i][2]]).draw();
                    }*/

                    list_of_classes = data['data']['class_table_data'];
                    for (var i = 0; i < list_of_classes.length; i++) {
                        class_table.row.add([list_of_classes[i][0], list_of_classes[i][1], list_of_classes[i][2], list_of_classes[i][3], list_of_classes[i][4], list_of_classes[i][5], list_of_classes[i][6]], "Started").draw();
                    }

                    lost_of_rels = data['data']['relationship_table_data'];
                    for (var i = 0; i < lost_of_rels.length; i++) {
                        relationship_table.row.add([lost_of_rels[i][0], lost_of_rels[i][1], lost_of_rels[i][2], lost_of_rels[i][3]]).draw();
                    }

                    // // create an array with nodes
                    nodes = new vis.DataSet(data['data']['node_data']);

                    // create an array with edges
                    edges = new vis.DataSet(data['data']['edge_data']);

                    // // create a network
                    var container = document.getElementById('mynetwork');

                    // // provide the data in the vis format
                    var data = {
                        nodes: nodes,
                        edges: edges
                    };
                    var options = {};
                    // // initialize your network!
                    network = new vis.Network(container, data, options);
                    network.on('click', function (properties) {
                        var ids = properties.nodes;
                        var clickedNodes = nodes.get(ids);
                        console.log('clicked nodes:', clickedNodes);
                    });

                    alert('A Checkpoint has been loaded.');

                } else { alert('Something went wrong'); }
            }

            $('#create-checkpoint').click(function (event) {
                node_data = nodes.get(nodes.getIds());
                edge_data = edges.get(edges.getIds());
                //location_table_data = location_table.rows().data().toArray();
                metadata_table_data = metadata_table.rows().data().toArray();
                class_table_data = class_table.rows().data().toArray();
                relationship_table_data = relationship_table.rows().data().toArray();

                data_to_save = {}
                data_to_save['node_data'] = node_data;
                data_to_save['edge_data'] = edge_data;
                //data_to_save['location_table_data'] = location_table_data;
                data_to_save['metadata_table_data'] = metadata_table_data;
                data_to_save['class_table_data'] = class_table_data;
                data_to_save['relationship_table_data'] = relationship_table_data;

                data_to_save['filename'] = $('#checkpoint-file').val();
                proxy_request("/create_checkpoint", "POST", data_to_save, checkpoint_done);

            });

            $('#load-metadata').click(function (event) {
                clear_everything();
                data = { input_file: $('#input-file').val() };
                // data needs to be json
                proxy_request("/get_metadata_csv", "POST", data, get_metadata_csv);
            });

            $('#load-checkpoint').click(function (event) {
                clear_everything();
                data = { filename: $('#checkpoint-file').val() };
                // data needs to be json
                proxy_request("/get_checkpoint", "POST", data, get_checkpoint_done);
            });

            /*
            $('#add-all-to-graph-btn').click(function (event) {

                
                location_table.rows().every(function (rowIdx, tableLoop, rowLoop) {


                    data = this.data();

                    $('#obj-type').text('Location');
                    $('#obj-row-id').text(data[0]);
                    $('#original-lbl').text(data[1]);
                    $('#obj-name').text(data[1]);
                    $('#brick-class').text(data[2]);
                    $('#description').text('');
                    $('#location').text('');

                    if ($('#brick-class').text() != "" && $('#obj-name').text() != "") {

                        newId = $('#obj-name').text() + " (" + $('#brick-class').text() + ")"

                        try {
                            nodes.add({ id: newId, label: newId });
                            class_table.row.add([newId, $('#obj-type').text(), $('#obj-row-id').text(), $('#original-lbl').text(), $('#brick-class').text(), $('#obj-name').text(), $('#description').text()]).draw();
                        } catch (err) {
                            //alert(newId + " is already in the network!");
                        }
                    }


                });

            });*/

            $('#convert-btn').click(function (event) {
                warning = 0;
                list_of_selected_rows = metadata_table.rows('.selected').data().toArray();
                
                for (var i = 0; i < list_of_selected_rows.length; i++) {

                    obj_row_id = list_of_selected_rows[i][0];
                    org_row_lbl = list_of_selected_rows[i][1];
                    obj_name = list_of_selected_rows[i][2];
                    brick_class = list_of_selected_rows[i][4];
                    description = list_of_selected_rows[i][3];

                    //the following information is something we can use for training
                    data_to_save = {"data_label":obj_name, "description":description, "brick_class":brick_class};
                    proxy_request("/update_model", "POST", data_to_save, update_model_done);

                    
                    if (brick_class != "" && obj_name != "") {
                        newId = obj_name + " (" + brick_class + ")"
                        pass = 1;
                        class_table_data = class_table.rows().data().toArray();
                        for (var j = 0; j < class_table_data.length; j++) {
                            existing_newId = class_table_data[j][0];
                            if (existing_newId == newId) {
                                //alert(newId + ' : Same Node ID already exist! please remove first!');
                                class_table.column(0).search(newId).draw();
                                //filtered_data = class_table.rows({ "filter": "applied" }).data().toArray()[0];
                                //newId = filtered_data[0];
                                //nodes.remove({ id: newId });
                                class_table.rows({ "filter": "applied" }).remove();
                                class_table.search('').columns().search('').draw();

                            }
                        }
                        if (pass == 1) {
                            try {
                                //nodes.add({ id: newId, label: newId });
                                class_table.row.add([newId, obj_row_id, org_row_lbl, brick_class, obj_name, description, "Started"]).draw();
                            } catch (err) {
                                //alert(newId + " is already in the network!");
                            }
                            metadata_table.row(list_of_selected_rows[i][0]).data([list_of_selected_rows[i][0], list_of_selected_rows[i][1], list_of_selected_rows[i][2], list_of_selected_rows[i][3], list_of_selected_rows[i][4], "Converted"]).draw();
                        }
                    } else {
                        warning = 1;
                    }
                }
                data = {};
                proxy_request("/reindex", "POST", data, reindexing_done);

                if (warning == 1)
                    alert('Some nodes were not ready to be convert to Brick Object. Please assign Brick classes to the selected rows');

            });

            $('#from-class-btn').click(function (event) {
                if (class_table.rows('.selected').data().toArray().length > 1) {
                    alert('Please do not select multiple objects');
                }
                else {
                    selected_class = class_table.row('.selected').data()[0];
                    $('#selected-from').text(selected_class);
                }
            });

            $('#to-class-btn').click(function (event) {
                selected_class = class_table.rows('.selected').data().toArray();
                selected_text = ''
                for (var i = 0; i < selected_class.length; i++) {
                    selected_text += selected_class[i][0] + ","
                }
                $('#selected-to').text(selected_text);
            });

            $('#from-graph-btn').click(function (event) {
                selected_node = network.getSelectedNodes();
                $('#selected-from').text(selected_node);
            });

            $('#to-graph-btn').click(function (event) {
                selected_node = network.getSelectedNodes();
                if ($('#selected-from') != selected_node) {
                    $('#selected-to').text(selected_node);
                } else {
                    alert('From and To can\'t be the same nodes!');
                }
            });

            $('#from-graph-btn-canvas').click(function (event) {
                selected_node = network.getSelectedNodes();
                $('#selected-from-canvas').text(selected_node);
            });

            $('#to-graph-btn-canvas').click(function (event) {
                selected_node = network.getSelectedNodes();
                if ($('#selected-from-canvas') != selected_node) {
                    $('#selected-to-canvas').text(selected_node);
                } else {
                    alert('From and To can\'t be the same nodes!');
                }
            });

            $('#clear-selected-btn').click(function (event) {
                selected_node = network.getSelectedNodes();
                $('#selected-from-canvas').text('');
                $('#selected-to-canvas').text('');
            });


            $('#suggest-selected-btn').click(function (event) {

                selected_rows = metadata_table.rows('.selected').data().toArray();

                if (selected_rows.length != 1) {
                    alert('Please select just 1 row to suggest.');
                }
                else {
                    selected_rows = metadata_table.row(selected_rows[0][0]).data();
                    $('#obj-row-id').text(selected_rows[0]);
                    $('#original-lbl').text(selected_rows[1]);
                    $('#obj-name').text(selected_rows[2]);
                    $('#description').text(selected_rows[3]);
                    $('#brick-class').text(selected_rows[4]);
                }

                keyword = selected_rows[0][2] + ' ' + selected_rows[3] + ' ' + $("#search-kwd").val() + ' ';
                data = { search_kwd: keyword };
                proxy_request("/search", "POST", data, search_btn_callback);

            });

            $('#select-all-btn').click(function (event) {
                //metadata_table.selectAll();
                metadata_table.rows( { search: 'applied' } ).select();

            });

            $('#select-none-btn').click(function (event) {
                //metadata_table.selectAll();
                metadata_table.rows().deselect();
            });

            $('#select-all-class-btn').click(function (event) {
                //metadata_table.selectAll();
                //class_table.rows().select();
                class_table.rows( { search: 'applied' } ).select();
            });

            $('#select-none-class-btn').click(function (event) {
                //metadata_table.selectAll();
                class_table.rows().deselect();
            });

            $('#select-all-rel-btn').click(function (event) {
                //metadata_table.selectAll();
                //relationship_table.rows().select();
                relationship_table.rows( { search: 'applied' } ).select();
                
            });

            $('#select-none-rel-btn').click(function (event) {
                //metadata_table.selectAll();
                relationship_table.rows().deselect();
            });


            $('#suggest-btn').click(function (event) {

                list_of_selected_rows = metadata_table.rows('.selected').data().toArray();
                data = { list_of_rows: list_of_selected_rows };
                proxy_request("/suggest_selected", "POST", data, suggest_selected_callback);

            });

            $('#mark-as-complete').click(function (event) {

                list_of_selected_rows = metadata_table.rows('.selected').data().toArray();
                for (var i = 0; i < list_of_selected_rows.length; i++) {
                    metadata_table.row(list_of_selected_rows[i][0]).data([list_of_selected_rows[i][0], list_of_selected_rows[i][1], list_of_selected_rows[i][2], list_of_selected_rows[i][3], list_of_selected_rows[i][4], "Complete"]).draw();
                }

            });

            $('#mark-as-pass').click(function (event) {

                list_of_selected_rows = metadata_table.rows('.selected').data().toArray();
                for (var i = 0; i < list_of_selected_rows.length; i++) {
                    metadata_table.row(list_of_selected_rows[i][0]).data([list_of_selected_rows[i][0], list_of_selected_rows[i][1], list_of_selected_rows[i][2], list_of_selected_rows[i][3], list_of_selected_rows[i][4], "Pass"]).draw();
                }

            });

            $('#class-mark-as-complete').click(function (event) {

                list_of_selected_rows = class_table.rows('.selected').data().toArray();

                class_table.rows('.selected').every(function (rowIdx, tableLoop, rowLoop) {
                    // The checks the id of the current row
                    class_table.row(rowIdx).data([class_table.row(rowIdx).data()[0], class_table.row(rowIdx).data()[1], class_table.row(rowIdx).data()[2], class_table.row(rowIdx).data()[3], class_table.row(rowIdx).data()[4], class_table.row(rowIdx).data()[5], "Completed"]).draw();
                });


            });

            $('#class-mark-as-pass').click(function (event) {

                list_of_selected_rows = class_table.rows('.selected').data().toArray();

                class_table.rows('.selected').every(function (rowIdx, tableLoop, rowLoop) {
                    // The checks the id of the current row
                    class_table.row(rowIdx).data([class_table.row(rowIdx).data()[0], class_table.row(rowIdx).data()[1], class_table.row(rowIdx).data()[2], class_table.row(rowIdx).data()[3], class_table.row(rowIdx).data()[4], class_table.row(rowIdx).data()[5], "Pass"]).draw();
                });

            });

            $('#create-brick-obj').click(function (event) {

                selected_node = network.getSelectedNodes()

                if ($('#brick-class').text() != "" && $('#obj-name').text() != "") {
                    newId = $('#obj-name').text() + " (" + $('#brick-class').text() + ")"
                    //nodes.remove({ id: newId });
                    //nodes.add({ id: newId, label: newId });
                    pass = 1;
                    class_table_data = class_table.rows().data().toArray();
                    for (var j = 0; j < class_table_data.length; j++) {
                        existing_newId = class_table_data[j][0];
                        if (existing_newId == newId) {
                            class_table.column(0).search(newId).draw();
                            //filtered_data = class_table.rows({ "filter": "applied" }).data().toArray()[0];
                            //newId = filtered_data[0];
                            //nodes.remove({ id: newId });
                            class_table.rows({ "filter": "applied" }).remove();
                            class_table.search('').columns().search('').draw();
                        }
                    }
                    class_table.row.add([newId, $('#obj-row-id').text(), $('#original-lbl').text(), $('#brick-class').text(), $('#obj-name').text(), $('#description').text(), "Started"]).draw();

                }
                else {
                    alert("Object name or Brick class can't be empty.");
                }

            });

            $('#clear-inspector-btn').click(function (event) {

                $('#obj-type').text('');
                $('#obj-row-id').text('');
                $('#original-lbl').text('');
                $('#brick-class').text('');
                $('#obj-name').text('');
                $('#description').text('');

            });

            $('#search-btn').click(function (event) {
                search_kwd = $("#search-kwd").val();
                data = { search_kwd: search_kwd };
                proxy_request("/search", "POST", data, search_btn_callback);
            });

            $('#reset-graph-btn').click(function (event) {
                nodes.clear();
                edges.clear();
            });

            $('#update-objname-btn').click(function (event) {
                obj_name = $("#new-obj-name").val();
                $('#obj-name').text(obj_name);

                metadata_table.row($('#obj-row-id').text()).data([$('#obj-row-id').text(), $('#original-lbl').text(), $('#obj-name').text(), $('#description').text(), $('#brick-class').text(), "Name Updated"]).draw();

            });

            $('#update-row-btn').click(function (event) {
                selected_rows = metadata_table.rows('.selected').data().toArray();
                brick_class = $("#search-result-list li.active b").text();

                if (brick_class == '') {
                    //alert('Please select one from the list after searching ..');
                }
                else {
                    if (selected_rows.length != 1) {
                        alert('Please select just 1 row to update.');
                    } else {
                        metadata_table.row(selected_rows[0][0]).data([selected_rows[0][0], selected_rows[0][1], selected_rows[0][2], selected_rows[0][3], brick_class, "Suggested"]).draw();
                        data_to_save = {"data_label":selected_rows[0][2], "description":selected_rows[0][3], "brick_class":brick_class};
                        proxy_request("/update_model", "POST", data_to_save, update_model_done);
                    }
                }

                obj_name = $("#updater-obj-name").val();
                if (obj_name != '')
                    {
                        metadata_table.row(selected_rows[0][0]).data([selected_rows[0][0], selected_rows[0][1], obj_name, selected_rows[0][3], brick_class, "Suggested"]).draw();
                        data_to_save = {"data_label":obj_name, "description":selected_rows[0][3], "brick_class":brick_class};
                        proxy_request("/update_model", "POST", data_to_save, update_model_done);
                    }
                obj_desc = $("#updater-obj-desc").val();
                if (obj_desc != '')
                    {
                        metadata_table.row(selected_rows[0][0]).data([selected_rows[0][0], selected_rows[0][1], selected_rows[0][2], obj_desc, brick_class, "Suggested"]).draw();
                        data_to_save = {"data_label":selected_rows[0][2], "description":obj_desc, "brick_class":brick_class};
                        proxy_request("/update_model", "POST", data_to_save, update_model_done);
                    }
                if (obj_desc != '' && obj_name != '')
                    {
                        metadata_table.row(selected_rows[0][0]).data([selected_rows[0][0], selected_rows[0][1], obj_name, obj_desc, brick_class, "Suggested"]).draw();
                        data_to_save = {"data_label":obj_name, "description":obj_desc, "brick_class":brick_class};
                        proxy_request("/update_model", "POST", data_to_save, update_model_done);
                    }

                    proxy_request("/reindex", "POST", data, reindexing_done);

                });

            $('#update-inspector-btn').click(function (event) {
                selected_rows = metadata_table.rows('.selected').data().toArray();
                brick_class = $("#search-result-list li.active b").text();
                $('#brick-class').text(brick_class);
            });

            $('#update-brick-btn').click(function (event) {
                brick_class = $("#search-result-list li.active b").text();
                $('#brick-class').text(brick_class);
                metadata_table.row($('#obj-row-id').text()).data([$('#obj-row-id').text(), $('#obj-name').text(), $('#description').text(), $('#brick-class').text(), "Suggested"]).draw();

            });

            $('#update-brick-rule-btn').click(function (event) {
                label_include = $('#label_include').val().split(",");
                label_exclude = $('#label_exclude').val().split(",");
                desc_include = $('#desc_include').val().split(",");
                desc_exclude = $('#desc_exclude').val().split(",");

                metadata_table_rows = metadata_table.rows().data().toArray();

                if (label_include.length != 0 && label_exclude.length != 0 && desc_include.length != 0 && desc_exclude.length != 0) {
                    for (let i = 0; i < metadata_table_rows.length; i++) {
                        label = metadata_table_rows[i][1];
                        description = metadata_table_rows[i][3];
                        check_label = check_node(label, label_include, label_exclude);
                        check_desc = check_node(description, desc_include, desc_exclude);
                        //alert(check_label +" " + check_desc  +" " + label +" " +  description);
                        brick_class = $("#search-result-list li.active b").text();

                        if (brick_class == '') {
                            alert('Please search and select a brick class type!');
                            return;
                        }
                        else {

                            if (check_label == true && check_desc == true) {
                                console.log(label, description, check_label, check_desc);
                                row_to_update = metadata_table_rows[i];
                                row_to_update[4] = brick_class;
                                row_to_update[5] = 'Rule-based Mapped';
                                metadata_table.row(i).data(row_to_update).draw();

                            }

                        }
                    }
                    /*
                    for (var i = 0; i < node_list.length; i++) {
                        for (var j = 0; j < node_list.length; j++) {
                            from_node_id = node_list[i];
                            to_node_id = node_list[j];
                            check_node_from = check_node(from_node_id, from_include, from_exclude);
                            check_node_to = check_node(to_node_id, to_include, to_exclude);
                            //console.log(from_node_id+" "+to_node_id+" "+check_node_from+" "+check_node_to);

                            rel_type = $("#rel_list_1 li.active").text();
                            if (check_node_from == true && check_node_to == true && rel_type != '') {
                                edges.add({
                                    from: from_node_id, to: to_node_id, rel_type: rel_type, id: slugify(from_node_id + ":" + to_node_id + ":" + rel_type),
                                    arrows: {
                                        to: {
                                            enabled: true,
                                            type: "arrow",
                                        }
                                    }
                                });
                                relationship_table.row.add([slugify(from_node_id + ":" + to_node_id + ":" + rel_type), from_node_id, to_node_id, rel_type]).draw();
                            };
                        }
                    }*/
                };
            });

            

            $('#create-edge-btn-canvas').click(function (event) {
                from_node = $('#selected-from-canvas').text();
                to_node = $('#selected-to-canvas').text();
                
                rel_type = $("#rel_list_3 li.active").text();
                if (rel_type == '' || from_node == '' || to_node == '') {
                    alert('Please select from_node, to_node, and a relationship type!');
                    return;
                }

                edge_id = slugify(from_node+ ":" + to_node + ":" + rel_type);
                edge_ids = edges.getIds();
                if (edge_ids.includes(edge_id) == false) {
                    edges.add({
                        from: from_node, to: to_node, rel_type: rel_type, id: edge_id,
                        arrows: {
                            to: {
                                enabled: true,
                                type: "arrow",
                            }
                        }
                    });
                    relationship_table.row.add([edge_id, from_node, to_node, rel_type]).draw();
                }
            });

            $('#create-edge-btn').click(function (event) {
                from_node = $('#selected-from').text();
                to_node = $('#selected-to').text();

                rel_type = $("#rel_list_2 li.active").text();
                if (rel_type == '' || from_node == '' || to_node == '') {
                    alert('Please select from_node, to_node, and a relationship type!');
                    return;
                }
                try {
                    /*
                    edges.add({
                        from: from_node, to: to_node, rel_type: rel_type, id: slugify(from_node + ":" + to_node + ":" + rel_type),
                        arrows: {
                            to: {
                                enabled: true,
                                type: "arrow",
                            }
                        }
                    });*/
                } catch (err) {
                    //alert('Edge already exists in the network!', from_node, to_node, rel_type);
                }
                ids_of_rel = [];
                for (var i = 0; i < relationship_table.rows().data().toArray().length; i++) {
                    ids_of_rel.push(relationship_table.rows().data().toArray()[i][0]);
                }
                to_node_list = to_node.split(",");

                for (var i = 0; i < to_node_list.length - 1; i++) {
                    id_to_add = slugify(from_node + ":" + to_node_list[i] + ":" + rel_type);
                    if (ids_of_rel.includes(id_to_add) == false) {

                        relationship_table_data = relationship_table.rows().data().toArray();
                        for (var j = 0; j < relationship_table_data.length; j++) {
                            existing_newId = relationship_table_data[j][0];
                            if (existing_newId == id_to_add) {
                                relationship_table.column(0).search(id_to_add).draw();
                                relationship_table.rows({ "filter": "applied" }).remove();
                                relationship_table.search('').columns().search('').draw();

                            }
                        }
                        relationship_table.row.add([id_to_add, from_node, to_node_list[i], rel_type]).draw();
                        ids_of_rel.push(id_to_add);
                    }
                }



            });

            $('#create-edges-btn').click(function (event) {
                alert('here');
                from_include = $('#from_include').val().split(",");
                from_exclude = $('#from_exclude').val().split(",");
                to_include = $('#to_include').val().split(",");
                to_exclude = $('#to_exclude').val().split(",");
                node_list = [];
                class_table_data = class_table.rows().data().toArray();
                for (var i = 0; i < class_table_data.length; i++) {
                    node_list.push(class_table_data[i][0]);
                }


                if (from_include.length != 0 && from_exclude.length != 0 && to_include.length != 0 && to_exclude.length != 0) {
                    for (var i = 0; i < node_list.length; i++) {
                        for (var j = 0; j < node_list.length; j++) {
                            from_node_id = node_list[i];
                            to_node_id = node_list[j];

                            check_node_from = check_node(from_node_id, from_include, from_exclude);
                            check_node_to = check_node(to_node_id, to_include, to_exclude);
                            //console.log(check_node_from+"--"+from_node_id+"--"+from_include+"--"+from_exclude);
                            //console.log(check_node_to+"--"+to_node_id+"--"+to_include+"--"+to_exclude);

                            if (check_node_from == true && check_node_to == true) {
                                rel_type = $("#rel_list_1 li.active").text();
                                if (rel_type == '') {
                                    alert('Please select a relationship type!');
                                    return;
                                }

                                id_to_add = slugify(from_node_id + ":" + to_node_id + ":" + rel_type);
                                relationship_table_data = relationship_table.rows().data().toArray();

                                for (var k = 0; k < relationship_table_data.length; k++) {
                                    existing_newId = relationship_table_data[k][0];
                                    if (existing_newId == id_to_add) {
                                        //alert(newId + ' : Same Node ID already exist! please remove first!');
                                        relationship_table.column(0).search(id_to_add).draw();
                                        //filtered_data = class_table.rows({ "filter": "applied" }).data().toArray()[0];
                                        //newId = filtered_data[0];
                                        //nodes.remove({ id: newId });
                                        relationship_table.rows({ "filter": "applied" }).remove();
                                        relationship_table.search('').columns().search('').draw();

                                    }
                                }
                                relationship_table.row.add([id_to_add, from_node_id, to_node_id, rel_type]).draw();
                            }
                        }
                    }
                };
            });

            $('#inspect-class-btn').click(function (event) {
                selected_rows = class_table.row('.selected');
                selected_rows = class_table.row(selected_rows[0]).data();
                $('#obj-row-id').text(selected_rows[1]);
                $('#original-lbl').text(selected_rows[2]);
                $('#obj-name').text(selected_rows[4]);
                $('#brick-class').text(selected_rows[3]);
                $('#description').text(selected_rows[5]);
                //$('#location').text('');

            });

            $('#remove-class-btn').click(function (event) {
                list_of_selected_rows = class_table.rows('.selected').data().toArray();
                for (var i = 0; i < list_of_selected_rows.length; i++) {
                    newId = list_of_selected_rows[i][0];
                    class_table.column(0).search(newId).draw();
                    class_table.rows({ "filter": "applied" }).remove();
                    class_table.search('').columns().search('').draw();
                }


            });

            $('#remove-rel-btn').click(function (event) {
                
                list_of_selected_rows = relationship_table.rows('.selected').data().toArray();
                for (var i = 0; i < list_of_selected_rows.length; i++) {
                    rel_id = list_of_selected_rows[i][0];
                    relationship_table.column(0).search(rel_id).draw();
                    relationship_table.rows({ "filter": "applied" }).remove();
                    relationship_table.search('').columns().search('').draw();
                    edges.remove([rel_id]);
                }

            });

            $('#remove-node-btn').click(function (event) {
                selected_node = network.getSelectedNodes();

                if (selected_node.length == 1) {
                    selected_node = selected_node[0];
                    nodes.remove({ id: selected_node });
                }
                else {
                    alert("Node not selected.");
                }

                edge_id_list = edges.getIds();

                slugified_node = slugify(selected_node);
                console.log('sluggified_node' + slugified_node);
                for (var k = 0; k < edge_id_list.length; k++) {
                    edge_id = edge_id_list[k];
                    
                    if(edge_id.includes(slugified_node)==true){
                        console.log(edge_id+" "+ true);
                        edges.remove({id:edge_id});
                    }
                };


            });

            $('#inspect-btn').click(function (event) {

                selected_rows = metadata_table.rows('.selected').data().toArray();
                if (selected_rows.length != 1) {
                    alert('Please select just 1 row to inspect.');
                }
                else {
                    selected_rows = metadata_table.row(selected_rows[0]).data();
                    $('#obj-row-id').text(selected_rows[0]);
                    $('#original-lbl').text(selected_rows[1]);
                    $('#obj-name').text(selected_rows[2]);
                    $('#description').text(selected_rows[3]);
                    $('#brick-class').text(selected_rows[4]);
                }

            });

            // // create an array with nodes
            nodes = new vis.DataSet([
            ]);

            // create an array with edges
            edges = new vis.DataSet([
            ]);

            // // create a network
            var container = document.getElementById('mynetwork');

            // // provide the data in the vis format
            var data = {
                nodes: nodes,
                edges: edges
            };
            var options = {};
            // // initialize your network!
            network = new vis.Network(container, data, options);
            network.on('click', function (properties) {
                var ids = properties.nodes;
                var clickedNodes = nodes.get(ids);
                console.log('clicked nodes:', clickedNodes);
            });

            metadata_table = $('#metadataTable').DataTable({
                dom: 'Bfrtip',
                language: {
                    info: "Showing _START_ to _END_ of _TOTAL_ entries ",
                },
                select: {
                    style: 'multi'
                },
                scrollY: '50vh',
                scrollCollapse: true,
                paging: false,

            });

            relationship_table = $('#relationshipTable').DataTable({
                dom: 'Bfrtip',
                language: {
                    info: "Showing _START_ to _END_ of _TOTAL_ entries ",
                },
                select: {
                    style: 'multi'
                },
                scrollY: '50vh',
                scrollCollapse: true,
                paging: false,
                select: {
                    style: 'multi'
                },
            });

            class_table = $('#classTable').DataTable({
                dom: 'Bfrtip',
                language: {
                    info: "Showing _START_ to _END_ of _TOTAL_ entries ",
                },
                select: {
                    style: 'multi'
                },
                scrollY: '50vh',
                scrollCollapse: true,
                paging: false,
                //rowId: 'Node ID'
            });

            $('#button').click(function () {
                class_table.row('.selected').remove().draw(false);
            });

            $('#button').click(function () {
                relationship_table.row('.selected').remove().draw(false);
            });

        });

    </script>

</head>

<body>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">ORNL VizBrick</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>

    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="input-group">
                        <input type="text" id="input-file" class="form-control" placeholder="Load from ..."
                            value="NIST.csv">
                        <span class="input-group-btn">
                            <button id="load-metadata" class="btn btn-default" type="button">Load (Start from
                                Scratch)</button>
                        </span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="panel panel-default">
                <div class="panel-body">
                    <button id="clear-everything" class="btn btn-default" type="button">Clear All</button>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="panel panel-default">
                <div class="panel-body">

                    <div class="input-group">

                        <input type="text" id="checkpoint-file" class="form-control"
                            placeholder="Save Checkpoint to ..." value="checkpoint.json">
                        <span class="input-group-btn">
                            <button id="create-checkpoint" class="btn btn-default" type="button">Save
                                Checkpoint</button>
                            <button id="load-checkpoint" class="btn btn-default" type="button">Load Checkpoint</button>
                        </span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-1">
        </div>
    </div>
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-7">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Metadata Table</h3>
                </div>
                <div class="panel-body" style="min-height: 770px; max-height: 770px;" id="panel-metadata-body">
                    <button id="select-all-btn" class="btn btn-default">Select All</button>
                    <button id="select-none-btn" class="btn btn-default">Select None</button>
                    <button id="suggest-btn" class="btn btn-default">Auto-suggestion</button>
                    <button id="inspect-btn" class="btn btn-default">Inspect</button>
                    <button id="convert-btn" class="btn btn-default">Convert to Brick Object</button>
                    <button id="add-row-btn" class="btn btn-default">Add a row</button>
                    <button id="mark-as-complete" class="btn btn-default">Complete</button>
                    <button id="mark-as-pass" class="btn btn-default">Pass</button>
                    <button id="show-stats" class="btn btn-default">Stats</button>
                    <hr />
                    <table id="metadataTable" class="display">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Data Label</th>
                                <th>Object Name</th>
                                <!--th>Location</th-->
                                <th>Description</th>
                                <th>Brick Class</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Search & Suggest</h3>
                </div>
                <div class="panel-body">
                    <div class="input-group">
                        <input type="text" id="search-kwd" class="form-control" placeholder="Search for...">
                        <span class="input-group-btn">
                            <button id="search-btn" class="btn btn-default" type="button">Search</button>
                        </span>
                    </div>
                    <hr />
                    <table class="table">
                        <tbody>
                            <tr>
                                <td>
                                    <b>Object Name :</b>
                                </td>
                                <td>
                                    <input type="text" id="updater-obj-name">
                                </td>
                                <td>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Description :</b>
                                </td>
                                <td>
                                    <input type="text" id="updater-obj-desc">
                                </td>
                                <td>

                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button id="suggest-selected-btn" class="btn btn-default" type="button">Suggest</button>
                    <button id="update-row-btn" class="btn btn-default" type="button">Update Row</button>
                </div>
                <div class="panel-body" style="min-height: 140px; max-height: 140px; overflow-y: scroll;">
                    <ul class="list-group" id="search-result-list">
                    </ul>
                </div>

            </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Metadata Table</h3>
                </div>
                <div class="panel-body">
                    <button id="update-brick-rule-btn" class="btn btn-default">Update Class (Rule-based)</button>
                    <hr />
                    <table class="table">
                        <tbody>
                            <tr>
                                <td>
                                    <b>Label (must include) :</b>
                                </td>
                                <td>
                                    <input type="text" id="label_include">
                                </td>
                                <td>

                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Label (must exclude) :</b>
                                </td>
                                <td>
                                    <input type="text" id="label_exclude">
                                </td>
                                <td>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Description (must include) :</b>
                                </td>
                                <td>
                                    <input type="text" id="desc_include">
                                </td>
                                <td>

                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Description (must exclude) :</b>
                                </td>
                                <td>
                                    <input type="text" id="desc_exclude">
                                </td>
                                <td>

                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
        <div class="col-md-1"></div>
    </div>
    <div class="row">
        <div class="col-md-1"></div>
        <!--div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Search & Suggest</h3>
                </div>
                <div class="panel-body">
                    <div class="input-group">
                        <input type="text" id="search-kwd" class="form-control" placeholder="Search for...">
                        <span class="input-group-btn">
                            <button id="search-btn" class="btn btn-default" type="button">Search with Kewords!</button>
                        </span>
                    </div>
                </div>
                <div class="panel-body" style="min-height: 140px; max-height: 140px; overflow-y: scroll;">
                    <ul class="list-group" id="search-result-list">
                    </ul>
                </div>

            </div>

        </div-->

        <div class="col-md-7">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Brick Object Table</h3>
                </div>
                <div class="panel-body" style="min-height: 760px; max-height: 760px;" id="panel-metadata-body">
                    <!--button id="inspect-class-btn" class="btn btn-default">Inspect</button-->
                    <button id="select-all-class-btn" class="btn btn-default">Select All</button>
                    <button id="select-none-class-btn" class="btn btn-default">Select None</button>
                    <button id="remove-class-btn" class="btn btn-default">Remove</button>
                    <button id="class-mark-as-complete" class="btn btn-default">Complete</button>
                    <button id="class-mark-as-pass" class="btn btn-default">Pass</button>
                    <hr />
                    <table id="classTable" class="display">
                        <thead>
                            <tr>
                                <th>Node ID</th>
                                <th>Source Row ID</th>
                                <th>Source Label</th>
                                <th>Brick Class</th>
                                <th>Object Name</th>
                                <th>Description</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <!--div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Brick Object Creator</h3>
                </div>
                <div class="panel-body" id="panel-canvas-body" style="min-height: 700px; max-height: 700px;">
                    
                    <button id="create-brick-obj" class="btn btn-default">Create a Brick Object</button>
                    <button id="clear-inspector-btn" class="btn btn-default">Clear</button>
                    <hr />
                    <div class="input-group">
                        <input type="text" id="new-obj-name" class="form-control" placeholder="">
                        <span class="input-group-btn">
                            <button id="update-objname-btn" class="btn btn-default" type="button">Update Object
                                Name</button>
                        </span>
                    </div>
                    <hr />
                    <table class="table">
                        <tbody>
                            <tr>
                                <td>
                                    <b>Row ID:</b>
                                </td>
                                <td>
                                    <div id="obj-row-id"></div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Original Label:</b>
                                </td>
                                <td>
                                    <div id="original-lbl"></div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Object Name:</b>
                                </td>
                                <td>
                                    <div id="obj-name"></div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Brick Class:</b>
                                </td>
                                <td>
                                    <div id="brick-class"></div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Description:</b>
                                </td>
                                <td>
                                    <div id="description"></div>
                                </td>
                            </tr>
                           
                        </tbody>
                    </table>
                    

                </div>
            </div>
        </div-->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Edge Creator</h3>
                </div>
                <div class="panel-body" id="panel-canvas-body">
                    <button id="from-class-btn" class="btn btn-default">From</button>
                    <button id="to-class-btn" class="btn btn-default">To</button>
                    <button id="create-edge-btn" class="btn btn-default">Create Relationships</button>
                    <hr />
                    <table class="table">
                        <tbody>
                            <tr>
                                <td>
                                    <b>From:</b>
                                </td>
                                <td>
                                    <div id="selected-from"></div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>To :</b>
                                </td>
                                <td>
                                    <div id="selected-to"></div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="panel-body" style="min-height: 100px; max-height: 100px; overflow-y: scroll;">
                        <ul class="list-group" id="rel_list_2">
                        </ul>
                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Rule-based Edge Creator !!</h3>
                </div>
                <div class="panel-body" id="panel-canvas-body">
                    <button id="create-edges-btn" class="btn btn-default">Create Relationships (beta)</button>
                    <hr />
                    <table class="table">
                        <tbody>
                            <tr>
                                <td>
                                    <b>From (must include) :</b>
                                </td>
                                <td>
                                    <input type="text" id="from_include">
                                </td>
                                <td>

                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>From (must exclude) :</b>
                                </td>
                                <td>
                                    <input type="text" id="from_exclude">
                                </td>
                                <td>

                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>To (must include) :</b>
                                </td>
                                <td>
                                    <input type="text" id="to_include">
                                </td>
                                <td>

                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>To (must exclude) :</b>
                                </td>
                                <td>
                                    <input type="text" id="to_exclude">
                                </td>
                                <td>

                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="panel-body" style="min-height: 100px; max-height: 100px; overflow-y: scroll;">
                        <ul class="list-group" id="rel_list_1">
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-1"></div>
    </div>
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-3">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Relationship Table</h3>
                </div>
                <div class="panel-body" style="min-height: 820px; max-height: 820px;" id="panel-location-body">
                    <button id="select-all-rel-btn" class="btn btn-default">Select All</button>
                    <button id="select-none-rel-btn" class="btn btn-default">Select None</button>
                    <button id="remove-rel-btn" class="btn btn-default">Remove</button>
                    <button id="add-to-canvas-btn" class="btn btn-default">Add to Graph</button>
                    <hr />
                    <table id="relationshipTable" class="display">
                        <thead>
                            <tr>
                                <th>Edge Id</th>
                                <th>From Node</th>
                                <th>To Node</th>
                                <th>Relationship Type</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-7">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Brick Graph</h3>
                </div>
                <div class="panel-body" id="panel-canvas-body">
                    <button id="reset-graph-btn" class="btn btn-default">Clear Graph</button>

                    <button id="clear-selected-btn" class="btn btn-default">Clear Selected</button>
                    <button id="remove-node-btn" class="btn btn-default">Remove Node</button>
                    <button id="from-graph-btn-canvas" class="btn btn-default">From</button>
                    <button id="to-graph-btn-canvas" class="btn btn-default">To</button>
                    <button id="create-edge-btn-canvas" class="btn btn-default">Create Edge</button>
                    <div id="selected-from-canvas"></div>
                    <div id="selected-to-canvas"></div>
                    <div class="panel-body" style="min-height: 100px; max-height: 100px; overflow-y: scroll;">
                        <ul class="list-group" id="rel_list_3">
                        </ul>
                    </div>
                    <hr />
                    <div class="input-group">

                        <input type="text" id="brick-file" class="form-control" placeholder="Save Brick to ..."
                            value="mybrick.ttl">
                        <span class="input-group-btn">
                            <button id="save-brick-btn" class="btn btn-default" type="button">Save
                                Brick</button>
                        </span>
                    </div>
                    <hr />
                    <div id="mynetwork"></div>
                </div>
            </div>
        </div>
        <div class="col-md-1"></div>
    </div>

</body>

</html>